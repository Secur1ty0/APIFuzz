# ğŸ” SwaggerFuzzer

ğŸš¨ **Swagger/OpenAPI è‡ªåŠ¨åŒ–æ¥å£ Fuzzer å·¥å…·**  
æ‰«æã€æµ‹è¯•æœªæˆæƒè®¿é—®ã€æ¥å£å¼‚å¸¸ã€æ•°æ®æ³„æ¼é—®é¢˜ â€”â€” é¢å‘ API å®‰å…¨æµ‹è¯•çš„è½»é‡åŒ–å‘½ä»¤è¡Œå·¥å…·ã€‚

![banner](https://raw.githubusercontent.com/Secur1ty0/SwaggerFuzzer/main/img/banner.png) 

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” è‡ªåŠ¨è§£æ OpenAPI 3.0/3.1 JSON æ–‡æ¡£ï¼ˆæ”¯æŒè¿œç¨‹å’Œæœ¬åœ°æ–‡ä»¶ï¼‰
- ğŸ§ª æ„é€ æ‰€æœ‰ API è¯·æ±‚ï¼ŒåŒ…æ‹¬ Pathã€Queryã€Headerã€Body å„ç§å‚æ•°
- âš¡ æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘æµ‹è¯•æ¥å£ï¼Œæå‡ fuzz é€Ÿåº¦
- ğŸ“„ è‡ªåŠ¨æ ¹æ® content-type æ„é€  JSONã€è¡¨å•ã€XMLã€æ–‡ä»¶ä¸Šä¼ ã€ZIPã€PDF ç­‰è¯·æ±‚ä½“
- ğŸ•µï¸ æ£€æµ‹æ•æ„Ÿå“åº”ï¼ˆå¦‚çŠ¶æ€ç  200ã€5XXã€422ã€400ï¼‰
- ğŸ–¨ï¸ æ§åˆ¶å°å½©è‰²è¾“å‡ºç®€æ´æ‘˜è¦ï¼ˆå¸¦çŠ¶æ€ç é«˜äº®ï¼‰
- ğŸ“¦ CSV æ–‡ä»¶ä¿å­˜æ¥å£è°ƒç”¨ç»“æœï¼Œæ”¯æŒåç»­åˆ†æ
- ğŸ”Œ æ”¯æŒä»£ç†æŠ“åŒ…ï¼ˆä¾‹å¦‚é€šè¿‡ BurpSuite æ‹¦æˆªï¼‰
- ğŸ” å¯æ·»åŠ è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼ˆå¦‚ Authorizationï¼‰

---

## ğŸ§‘â€ğŸ’» å®‰è£…ä¸ä½¿ç”¨

### ğŸ”§ ç¯å¢ƒä¾èµ–

- Python >= 3.8
- pip install requirements.txt:

```bash
pip install -r requirements.txt
```

### ğŸš€ å¿«é€Ÿä½¿ç”¨

```bash
python main.py -u http://example.com -f swagger.json
```

æˆ–è€…åªä½¿ç”¨è¿œç¨‹åœ°å€ï¼š

```bash
python main.py -u http://example.com/swagger/v1/swagger.json
```

![help](./img/help.png) 

### ğŸ§° æ”¯æŒå‚æ•°

| å‚æ•°              | è¯´æ˜                                    | ç¤ºä¾‹                                   |
| ----------------- | --------------------------------------- | -------------------------------------- |
| `-u`, `--url`     | å¿…å¡«ï¼Œbase URL æˆ–å®Œæ•´ OpenAPI JSON åœ°å€ | `http://target.com`                    |
| `-f`, `--file`    | å¯é€‰ï¼ŒOpenAPI JSON æœ¬åœ°è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„   | `./swagger.json`                       |
| `-p`, `--proxy`   | è®¾ç½®ä»£ç†                                | `http://127.0.0.1:8080`                |
| `-t`, `--threads` | å¤šçº¿ç¨‹æ•°é‡ï¼ˆé»˜è®¤1ï¼‰                     | `-t 5`                                 |
| `-o`, `--output`  | è¾“å‡ºæ–‡ä»¶æ ¼å¼ï¼ˆå½“å‰ä»…æ”¯æŒ csvï¼‰          | `-o csv`                               |
| `-d`, `--delay`   | æ¯ä¸ªè¯·æ±‚é—´éš”ç§’æ•°                        | `-d 0.5`                               |
| `--header`        | è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼ˆå¯é‡å¤ï¼‰                  | `--header="Authorization: Bearer xxx"` |

------

## ğŸ” ç¤ºä¾‹

![](./img/example.jpg)

------

## ğŸ“Œ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ SwaggerFuzzer.py     # ä¸»ç¨‹åºé€»è¾‘ï¼ˆåŠ è½½ specã€æ„é€ è¯·æ±‚ã€å‘é€ä¸è®°å½•ï¼‰
â”œâ”€â”€ util.py              # å·¥å…·å‡½æ•°ï¼ˆheader è§£æã€URL æ‹¼æ¥ã€åŠ è½½ Swagger æ–‡æ¡£ï¼‰
â”œâ”€â”€ requirements.txt     # ä¾èµ–åº“
â”œâ”€â”€ README.md            # ä½¿ç”¨è¯´æ˜
```

------

## âœ… TODO åˆ—è¡¨

-  ğŸš§ å…¼å®¹ Swagger/OpenAPI 2.0ï¼ˆè¿›è¡Œä¸­ï¼‰
-  ğŸš§ å¢åŠ å‚æ•°æ¨¡ç³Šå€¼ç”Ÿæˆï¼ˆå¦‚é•¿å­—ç¬¦ä¸²ã€éæ³•å­—ç¬¦ã€uuidï¼‰

------

## ğŸ™ æœ€å

æœ¬å·¥å…·å—å¯å‘äºå¸¸è§å®‰å…¨æµ‹è¯•æµç¨‹ä¸­å¯¹ Swagger è‡ªåŠ¨åŒ–åˆ©ç”¨çš„éœ€æ±‚ï¼Œé€‚åˆæ­é… BurpSuite æˆ–è‡ªå®šä¹‰æ¸—é€å·¥å…·é“¾ä½¿ç”¨ã€‚

